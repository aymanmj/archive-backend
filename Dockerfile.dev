# Backend (NestJS) - Dev
FROM node:20-alpine

WORKDIR /app

RUN apk add --no-cache python3 make g++ \
 && corepack enable

# نسخ ملفات التعريف أولاً لتحسين الكاش
COPY package.json pnpm-lock.yaml* ./

RUN pnpm install

# الآن السورس
COPY . .

EXPOSE 3000

# استخدم start:dev (watch) — غيّره لو اسم سكريبتك مختلف
CMD ["pnpm", "start:dev"]
